import{r as d,j as e}from"./ui-C9UzXxo-.js";import{P as z}from"./page-template-B2HXPu-s.js";import{u as G,K as I,S as J,t as A}from"./app-CePVSpCk.js";import{S as Q,a as X,b as Y,c as Z,d as ee}from"./select-79vLaRYu.js";import{A as te}from"./arrow-left-CLCYWjlI.js";import{C as ae,T as se}from"./trending-down-BBDyDMXb.js";import{D as re}from"./dollar-sign-BZxmLz_1.js";import{C as ne}from"./clock-DvHC5ovF.js";import{T as B}from"./trending-up-Ne7cjba9.js";import"./vendor-CxtKjBZA.js";import"./textarea-CiZFgYfM.js";import"./language-BWaL1pXC.js";import"./CookieConsentBanner-9JM6Tk5v.js";import"./globe-DIoyL4mD.js";import"./switch-BT9_4soN.js";import"./copy-BbEiGrsE.js";import"./chevron-up-FpzKnv5W.js";import"./credit-card-Cw26BS3B.js";import"./settings-CabqR4KC.js";import"./users-B2V-gWAi.js";import"./coins-Curs0q0e.js";import"./user-Cs-z8Fus.js";import"./use-favicon-BlwZF4jE.js";/* empty css            *//* empty css                  */import"./utils-2yqaTY3d.js";import"./index-BK2YBUn9.js";function Be(){var j,f,N,b,w,v,k,_,S,C,D,L,P,T;const{t}=G(),{employeeSalary:o,payrollRuns:p,selectedPayrollRun:U,payrollData:r}=I().props,[c,O]=d.useState(U),[y,E]=d.useState((r==null?void 0:r.salaryBreakdown)||{earnings:{},deductions:{}}),[s,F]=d.useState((r==null?void 0:r.attendanceSummary)||{}),[l,H]=d.useState((r==null?void 0:r.payrollCalculation)||{}),[g,M]=d.useState((r==null?void 0:r.attendanceRecords)||[]),[h,R]=d.useState((r==null?void 0:r.currentMonth)||null),[x,u]=d.useState(!1),$=async a=>{var i;if(a!==((i=c==null?void 0:c.id)==null?void 0:i.toString())){u(!0);try{const n=await fetch(route("hr.employee-salaries.get-payroll-calculation",{employeeSalary:o.id,payrollRun:a}));if(n.ok){const m=await n.json(),K=p.find(q=>q.id.toString()===a);O(K),E(m.salaryBreakdown||{earnings:{},deductions:{}}),F(m.attendanceSummary||{}),H(m.payrollCalculation||{}),M(m.attendanceRecords||[]),R(m.currentMonth)}else A.error(t("Failed to load payroll data"))}catch{A.error(t("Failed to load payroll data"))}finally{u(!1)}}},V=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Payroll Management"),href:route("hr.employee-salaries.index")},{title:t("Employee Salaries"),href:route("hr.employee-salaries.index")},{title:t("Payroll Calculation")}],W=[{label:t("Back to Salaries"),icon:e.jsx(te,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:()=>J.get(route("hr.employee-salaries.index"))}];return e.jsx(z,{title:`${t("Payroll Calculation")} - ${o.employee.name}`,url:"/hr/employee-salaries/payroll-calculation",actions:W,breadcrumbs:V,noPadding:!0,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ae,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o.employee.name}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[t("Payroll Calculation for")," ",h?new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"long"}):"-"]})]})]}),e.jsx("div",{className:"w-64",children:e.jsxs(Q,{value:((j=c==null?void 0:c.id)==null?void 0:j.toString())||"",onValueChange:$,disabled:x,children:[e.jsx(X,{children:e.jsx(Y,{placeholder:t("Select Payroll Run")})}),e.jsx(Z,{children:p==null?void 0:p.map(a=>e.jsxs(ee,{value:a.id.toString(),children:[a.title," (",new Date(a.pay_period_start).toLocaleDateString()," - ",new Date(a.pay_period_end).toLocaleDateString(),")"]},a.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:t("Basic Salary")})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:(f=window.appSettings)==null?void 0:f.formatCurrency(o.basic_salary||0)})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:t("Working Days")})]}),e.jsx("p",{className:"text-2xl font-bold text-green-900 dark:text-green-100",children:s.total_working_days||0})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-purple-600",children:t("Net Salary")})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:(N=window.appSettings)==null?void 0:N.formatCurrency(l.net_salary||0)})]})]})]}),x&&e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),e.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:t("Loading payroll data...")})]})}),!x&&e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t("Attendance Summary")}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.total_working_days}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("Working Days")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.present_days}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("Present Days")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:s.half_days}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("Half Days")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:s.absent_days}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("Absent Days")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:s.leave_days||0}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("Paid Leave Days")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:s.unpaid_leave_days||0}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("Total Unpaid Leave")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"(Unpaid Leaves + Half Days + Absent)"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[(Number(s.overtime_hours)||0).toFixed(1),"h"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("Overtime")})]})]})]}),!x&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(B,{className:"h-5 w-5 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("Earnings")})]}),e.jsxs("div",{className:"space-y-3",children:[Object.entries(y.earnings||{}).map(([a,i])=>{var n;return e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:a}),e.jsx("span",{className:"font-mono text-green-600",children:(n=window.appSettings)==null?void 0:n.formatCurrency(i)})]},a)}),e.jsxs("div",{className:"flex justify-between items-center py-2 font-semibold text-lg border-t-2 border-green-200",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:t("Total Earnings")}),e.jsx("span",{className:"font-mono text-green-600",children:(b=window.appSettings)==null?void 0:b.formatCurrency(l.total_earnings||0)})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(se,{className:"h-5 w-5 text-red-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("Deductions")})]}),e.jsxs("div",{className:"space-y-3",children:[Object.entries(y.deductions||{}).map(([a,i])=>{var n;return e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:a}),e.jsx("span",{className:"font-mono text-red-600",children:(n=window.appSettings)==null?void 0:n.formatCurrency(i)})]},a)}),e.jsxs("div",{className:"flex justify-between items-center py-2 font-semibold text-lg border-t-2 border-red-200",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:t("Total Deductions")}),e.jsx("span",{className:"font-mono text-red-600",children:(w=window.appSettings)==null?void 0:w.formatCurrency(l.total_deductions||0)})]})]})]})]}),!x&&e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t("Daily Attendance Records")})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t("Date")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t("Clock In")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t("Clock Out")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t("Total Hours")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t("Overtime")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t("Status")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:g&&g.length>0?g.map((a,i)=>{var n;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:((n=window.appSettings)==null?void 0:n.formatDateTime(a.date,!1))||new Date(a.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-green-600",children:a.clock_in||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-red-600",children:a.clock_out||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900 dark:text-white",children:a.total_hours?`${Number(a.total_hours).toFixed(2)}h`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-orange-600",children:a.overtime_hours>0?`${Number(a.overtime_hours).toFixed(1)}h`:"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ${a.status==="present"?"bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20":a.status==="absent"?"bg-red-50 text-red-700 ring-1 ring-inset ring-red-600/20":a.status==="half_day"?"bg-yellow-50 text-yellow-700 ring-1 ring-inset ring-yellow-600/20":a.status==="holiday"?"bg-purple-50 text-purple-700 ring-1 ring-inset ring-purple-600/20":a.status==="on_leave"?"bg-blue-50 text-blue-700 ring-1 ring-inset ring-blue-600/20":"bg-gray-50 text-gray-700 ring-1 ring-inset ring-gray-600/20"}`,children:a.status==="present"?t("Present"):a.status==="absent"?t("Absent"):a.status==="half_day"?t("Half Day"):a.status==="holiday"?t("Holiday"):a.status==="on_leave"?t("On Leave"):a.status||"-"}),a.is_late&&e.jsx("span",{className:"ml-1 inline-flex items-center rounded-md px-1 py-0.5 text-xs font-medium bg-red-50 text-red-700 ring-1 ring-inset ring-red-600/20",children:t("Late")}),a.is_early_departure&&e.jsx("span",{className:"ml-1 inline-flex items-center rounded-md px-1 py-0.5 text-xs font-medium bg-orange-50 text-orange-700 ring-1 ring-inset ring-orange-600/20",children:t("Early")})]})]},i)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:t("No attendance records found for this month")})})})]})})]}),!x&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t("Final Calculation")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t("Base Salary")}),e.jsx("span",{className:"font-mono text-blue-600",children:(v=window.appSettings)==null?void 0:v.formatCurrency(o.basic_salary)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t("Total Earnings")}),e.jsx("span",{className:"font-mono text-green-600",children:(k=window.appSettings)==null?void 0:k.formatCurrency(l.total_earnings||0)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t("Per Day Salary")}),e.jsx("span",{className:"font-mono text-blue-600",children:(_=window.appSettings)==null?void 0:_.formatCurrency(l.per_day_salary||0)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[t("Unpaid Leave Deduction")," (",s.unpaid_leave_from_leave||0," days)"]}),e.jsxs("span",{className:"font-mono text-red-600",children:["- ",(S=window.appSettings)==null?void 0:S.formatCurrency((l.per_day_salary||0)*(s.unpaid_leave_from_leave||0))]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[t("Half Day Deduction")," (",s.half_days," × 0.5)"]}),e.jsxs("span",{className:"font-mono text-orange-600",children:["- ",(C=window.appSettings)==null?void 0:C.formatCurrency((l.per_day_salary||0)*(s.half_days||0)*.5)]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[t("Absent Day Deduction")," (",s.absent_days," days)"]}),e.jsxs("span",{className:"font-mono text-red-600",children:["- ",(D=window.appSettings)==null?void 0:D.formatCurrency((l.per_day_salary||0)*(s.absent_days||0))]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t("Overtime Amount")}),e.jsxs("span",{className:"font-mono text-green-600",children:["+ ",(L=window.appSettings)==null?void 0:L.formatCurrency(l.overtime_amount||0)]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t("Total Deductions")}),e.jsxs("span",{className:"font-mono text-red-600",children:["- ",(P=window.appSettings)==null?void 0:P.formatCurrency(l.total_deductions||0)]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 font-bold text-xl border-t-2 border-purple-200",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:t("Net Salary")}),e.jsx("span",{className:"font-mono text-purple-600",children:(T=window.appSettings)==null?void 0:T.formatCurrency(l.net_salary||0)})]})]}),e.jsxs("div",{className:"mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("strong",{children:[t("Calculation Formula"),":"]})," ",t("Net Salary")," = (",t("Basic Salary")," + ",t("Allowances"),") - (",t("Per Day Salary")," × ",t("Unpaid Leave Days"),") + ",t("Overtime")," - ",t("Deductions")]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:[e.jsx("p",{children:e.jsxs("strong",{children:[t("Unpaid Leave Days Breakdown"),":"]})}),e.jsxs("p",{children:["• Unpaid Leaves: ",s.unpaid_leave_from_leave||0," days"]}),e.jsxs("p",{children:["• Absent Days: ",s.absent_days||0," days"]}),e.jsxs("p",{children:["• Half Days: ",s.half_days||0," × 0.5 = ",(s.half_days||0)*.5," days"]}),e.jsx("p",{children:e.jsxs("strong",{children:["Total Unpaid Days: ",s.unpaid_leave_days||0," days"]})})]})]})]})]})})}export{Be as default};
