import{r as g,j as c}from"./ui-C9UzXxo-.js";import{P as D}from"./page-template-B2HXPu-s.js";import{C as q}from"./CrudTable-Dqp1N8Wk.js";import{t as o}from"./i18n-_BYBrwL-.js";import{u as M,K as O,t as d,S as l}from"./app-CePVSpCk.js";import{P as U}from"./pagination-ByvlncqM.js";import{S as V}from"./search-and-filter-bar-B2CgZCxN.js";import"./vendor-CxtKjBZA.js";import"./textarea-CiZFgYfM.js";import"./select-79vLaRYu.js";import"./index-BK2YBUn9.js";import"./chevron-up-FpzKnv5W.js";import"./language-BWaL1pXC.js";import"./CookieConsentBanner-9JM6Tk5v.js";import"./globe-DIoyL4mD.js";import"./switch-BT9_4soN.js";import"./copy-BbEiGrsE.js";import"./credit-card-Cw26BS3B.js";import"./settings-CabqR4KC.js";import"./dollar-sign-BZxmLz_1.js";import"./users-B2V-gWAi.js";import"./clock-DvHC5ovF.js";import"./coins-Curs0q0e.js";import"./user-Cs-z8Fus.js";import"./use-favicon-BlwZF4jE.js";import"./table-C8TGnN1g.js";import"./ticket-DmZKwvAa.js";import"./unlink-BcdgK3yb.js";import"./wrench-CGU7Ft1Y.js";import"./arrow-left-CLCYWjlI.js";import"./arrow-right-C7JdH4Ti.js";import"./circle-help-C0S-oTMA.js";import"./lock-open-DSiBsvyN.js";import"./award-T4ZI43xQ.js";import"./wallet-DeVx02LK.js";import"./bell-CaHg65eG.js";import"./cookie-DINhGU1S.js";import"./building-2-Bxzvq01n.js";import"./building-CTTlMSBK.js";import"./trending-down-BBDyDMXb.js";import"./camera-B6YrOv6y.js";import"./chart-column-BuvtPv5K.js";import"./chart-no-axes-column-increasing-DpU2YTLr.js";import"./wifi-BWLuvSZA.js";import"./circle-alert-CPcUaQHG.js";import"./circle-check-big-QRVzFaq_.js";import"./circle-check-Bsqe1Oy2.js";import"./circle-hahOXJb0.js";import"./clipboard-list-CYu519l_.js";import"./code-DLKgizn0.js";import"./tag-DLA_9-Gh.js";import"./download-Dy8kf_tz.js";import"./ellipsis-B7Dcpmjs.js";import"./eye-off-D_POAzrb.js";import"./eye-Ds3O8uul.js";import"./instagram-DJ274emi.js";import"./filter-CJHBgxPm.js";import"./grip-vertical-GkNxvp67.js";import"./hard-drive-CvIusyLX.js";import"./heart-BxdfWe5j.js";import"./info-Cfzy708t.js";import"./layers-i14JjJ6T.js";import"./target-ChKhh3Jh.js";import"./link-2-Dyh9Asfo.js";import"./twitter-DvSPin83.js";import"./list-gVaFRlBo.js";import"./lock-BmEkJcEt.js";import"./mail-wmSCdBQm.js";import"./map-pin-CqHzBf39.js";import"./menu-C113HrJq.js";import"./monitor-CP12Y-ih.js";import"./phone-DUkL7MZF.js";import"./play-GEQInAgQ.js";import"./printer-CupyjDD-.js";import"./qr-code-C0PGAHLZ.js";import"./quote-DD8yfV5f.js";import"./refresh-cw-Dvtr6Xsn.js";import"./send-BHiBrVVZ.js";import"./server-B0O429oP.js";import"./shield-CGsXD3Oj.js";import"./square-pen-Df-vO64U.js";import"./star-Cn_AU9AC.js";import"./trash-2-3E96f3UA.js";import"./trash-D_jTiZX2.js";import"./trending-up-Ne7cjba9.js";import"./triangle-alert-CTrT4JQG.js";import"./type-uKUPsFU3.js";import"./user-plus-D-lxH5Xo.js";import"./zap-DH-5T0aI.js";/* empty css            *//* empty css                  */import"./utils-2yqaTY3d.js";const b={entity:{endpoint:route("plan-orders.index"),permissions:{view:"view-plan-orders",create:"create-plan-orders",edit:"edit-plan-orders",delete:"delete-plan-orders"}},description:o("Manage plan orders and subscription requests"),table:{columns:[{key:"order_number",label:o("Order Number"),sortable:!0},{key:"ordered_at",label:o("Order Date"),sortable:!0,render:r=>`${window.appSettings.formatDateTime(r,!1)}`},{key:"user.name",label:o("User Name"),sortable:!1},{key:"plan.name",label:o("Plan Name"),sortable:!1},{key:"original_price",label:o("Original Price"),render:r=>`${window.appSettings.formatCurrency(r)}`},{key:"coupon_code",label:o("Coupon Code"),render:r=>r||"-"},{key:"discount_amount",label:o("Discount"),render:r=>r>0?`-${window.appSettings.formatCurrency(r)}`:"-"},{key:"final_price",label:o("Final Price"),render:r=>`${window.appSettings.formatCurrency(r)}`},{key:"status",label:o("Status"),render:r=>{const s={pending:{label:o("Pending"),className:"bg-yellow-100 text-yellow-800"},approved:{label:o("Approved"),className:"bg-green-100 text-green-800"},rejected:{label:o("Rejected"),className:"bg-red-100 text-red-800"}};return(s[r]||s.pending).label}}],actions:[{label:o("Approve"),icon:"Check",action:"approve",className:"text-green-600",condition:r=>r.status==="pending",requiredPermission:"approve-plan-orders"},{label:o("Reject"),icon:"X",action:"reject",className:"text-red-600",condition:r=>r.status==="pending",requiredPermission:"reject-plan-orders"}]},search:{placeholder:o("Search orders...")},filters:[{key:"status",label:o("Status"),type:"select",options:[{value:"all",label:o("All Status")},{value:"pending",label:o("Pending")},{value:"approved",label:o("Approved")},{value:"rejected",label:o("Rejected")}]}]};function xr(){var k,w,x;const{t:r}=M(),{flash:s,planOrders:a,filters:p={},auth:f,currencySymbol:j}=O().props,_=(f==null?void 0:f.permissions)||[],[n,P]=g.useState(p.search||""),[m,h]=g.useState({}),[F,C]=g.useState(!1);g.useEffect(()=>{s!=null&&s.success&&d.success(s.success),s!=null&&s.error&&d.error(s.error)},[s]),g.useEffect(()=>{var t;const e={};(t=b.filters)==null||t.forEach(i=>{e[i.key]=p[i.key]||"all"}),h(e)},[]);const N=(e,t)=>{if(e==="approve")l.post(route("plan-orders.approve",t.id),{},{onSuccess:()=>{d.success(r("Plan order approved successfully"))},onError:()=>{d.error(r("Failed to approve plan order"))}});else if(e==="reject"){const i=prompt(r("Rejection reason (optional):"));l.post(route("plan-orders.reject",t.id),{notes:i},{onSuccess:()=>{d.success(r("Plan order rejected successfully"))},onError:()=>{d.error(r("Failed to reject plan order"))}})}},A=e=>{e.preventDefault(),v()},v=()=>{const e={page:1};n&&(e.search=n),Object.entries(m).forEach(([t,i])=>{i&&i!=="all"&&(e[t]=i)}),p.per_page&&(e.per_page=p.per_page),l.get(route("plan-orders.index"),e,{preserveState:!0,preserveScroll:!0})},E=(e,t)=>{h(y=>({...y,[e]:t}));const i={page:1};n&&(i.search=n);const u={...m,[e]:t};Object.entries(u).forEach(([y,S])=>{S&&S!=="all"&&(i[y]=S)}),p.per_page&&(i.per_page=p.per_page),l.get(route("plan-orders.index"),i,{preserveState:!0,preserveScroll:!0})},$=[{title:r("Dashboard"),href:route("dashboard")},{title:r("Plans"),href:route("plans.index")},{title:r("Plan Orders")}],R=()=>Object.entries(m).some(([e,t])=>t&&t!=="")||n!=="",T=(k=b.table.actions)==null?void 0:k.map(e=>({...e,label:r(e.label)}));return c.jsxs(D,{title:r("Plan Orders"),url:"/plan-orders",breadcrumbs:$,noPadding:!0,children:[c.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:c.jsx(V,{searchTerm:n,onSearchChange:P,onSearch:A,filters:((w=b.filters)==null?void 0:w.map(e=>{var t;return{name:e.key,label:r(e.label),type:"select",value:m[e.key]||"",onChange:i=>E(e.key,i),options:((t=e.options)==null?void 0:t.map(i=>({value:i.value,label:r(i.label)})))||[]}}))||[],showFilters:F,setShowFilters:C,hasActiveFilters:R,activeFilterCount:()=>Object.values(m).filter(e=>e&&e!=="").length+(n?1:0),onResetFilters:()=>{P(""),h({}),l.get(route("plan-orders.index"),{page:1},{preserveState:!0,preserveScroll:!0})},onApplyFilters:v,currentPerPage:((x=p.per_page)==null?void 0:x.toString())||"10",onPerPageChange:e=>{const t={page:1,per_page:parseInt(e)};n&&(t.search=n),Object.entries(m).forEach(([i,u])=>{u&&u!==""&&(t[i]=u)}),l.get(route("plan-orders.index"),t,{preserveState:!0,preserveScroll:!0})}})}),c.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[c.jsx(q,{columns:b.table.columns.map(e=>({...e,label:r(e.label),render:e.key==="original_price"||e.key==="final_price"?t=>`${j}${t}`:e.key==="discount_amount"?t=>t>0?`-${j}${t}`:"-":e.render})),actions:T,data:(a==null?void 0:a.data)||[],from:(a==null?void 0:a.from)||1,onAction:N,permissions:_,entityPermissions:b.entity.permissions}),c.jsx(U,{from:(a==null?void 0:a.from)||0,to:(a==null?void 0:a.to)||0,total:(a==null?void 0:a.total)||0,links:a==null?void 0:a.links,entityName:r("plan orders"),onPageChange:e=>{if(e){const t=new URL(e,window.location.origin);p.per_page&&t.searchParams.set("per_page",p.per_page.toString()),l.get(t.toString())}}})]})]})}export{xr as default};
