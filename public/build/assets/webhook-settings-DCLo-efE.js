import{r as i,j as e}from"./ui-C9UzXxo-.js";import{u as q,ah as X,ae as D,l as M,n as W,B as x,o as E,D as $,e as J,f as K,h as Q,L as y,I as Y,X as Z,s as _,P as ee,aj as k,t as u}from"./app-CePVSpCk.js";import{S as L,a as O,b as A,c as P,d as p}from"./select-79vLaRYu.js";import{T as se,a as te,b as v,c as j,d as ae,e as g}from"./table-C8TGnN1g.js";import{C as re}from"./CrudDeleteModal-CqSiuuPI.js";import{L as le}from"./link-2-Dyh9Asfo.js";import{S as ne}from"./square-pen-Df-vO64U.js";import{T as oe}from"./trash-2-3E96f3UA.js";import"./vendor-CxtKjBZA.js";/* empty css            *//* empty css                  */import"./utils-2yqaTY3d.js";import"./index-BK2YBUn9.js";import"./chevron-up-FpzKnv5W.js";function ke({webhooks:F=[]}){const{t:s}=q(),[S,b]=i.useState(F),[U,d]=i.useState(!1),[c,C]=i.useState(null),[I,f]=i.useState(!1),[n,N]=i.useState(null),[m,h]=i.useState({module:"",method:"",url:""}),T=()=>{h({module:"",method:"",url:""}),C(null)},R=()=>{T(),d(!0)},z=t=>{h({module:t.module,method:t.method,url:t.url}),C(t),d(!0)},B=async t=>{var a,o;t.preventDefault();try{if(c){const r=await k.put(route("settings.webhooks.update",c.id),m);b(l=>l.map(w=>w.id===c.id?r.data.webhook:w)),u.success(r.data.message)}else{const r=await k.post(route("settings.webhooks.store"),m);b(l=>[...l,r.data.webhook]),u.success(r.data.message)}d(!1),T()}catch(r){const l=((o=(a=r.response)==null?void 0:a.data)==null?void 0:o.message)||s("An error occurred");u.error(l)}},G=t=>{N(t),f(!0)},H=async()=>{var t,a;if(n)try{const o=await k.delete(route("settings.webhooks.destroy",n.id));b(r=>r.filter(l=>l.id!==n.id)),u.success(o.data.message)}catch(o){const r=((a=(t=o.response)==null?void 0:t.data)==null?void 0:a.message)||s("An error occurred");u.error(r)}finally{f(!1),N(null)}},V=()=>{f(!1),N(null)};return e.jsx(X,{title:s("Webhook Settings"),description:s("Manage webhooks for external integrations"),action:e.jsxs(x,{onClick:R,size:"sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),s("Add Webhook")]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(v,{className:"bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx(j,{className:"py-2.5 font-semibold",children:s("Module")}),e.jsx(j,{className:"py-2.5 font-semibold",children:s("Method")}),e.jsx(j,{className:"py-2.5 font-semibold",children:s("URL")}),e.jsx(j,{className:"w-24 py-2.5 font-semibold text-right",children:s("Actions")})]})}),e.jsx(ae,{children:S.length===0?e.jsx(v,{children:e.jsx(g,{colSpan:4,className:"h-24 text-center text-muted-foreground dark:text-gray-400",children:s("No webhooks configured")})}):S.map(t=>e.jsxs(v,{className:"hover:bg-gray-50 dark:hover:bg-gray-700 border-b dark:border-gray-700 dark:bg-gray-900",children:[e.jsx(g,{className:"py-2.5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:t.module})]})}),e.jsx(g,{className:"py-2.5",children:e.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${t.method==="GET"?"bg-blue-50 text-blue-700 ring-blue-700/10 dark:bg-blue-900/30 dark:text-blue-400 dark:ring-blue-400/30":"bg-green-50 text-green-700 ring-green-700/10 dark:bg-green-900/30 dark:text-green-400 dark:ring-green-400/30"}`,children:t.method})}),e.jsx(g,{className:"py-2.5",children:e.jsx("div",{className:"max-w-xs truncate text-sm font-mono text-muted-foreground dark:text-gray-400",children:t.url})}),e.jsx(g,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(D,{children:e.jsxs(M,{children:[e.jsx(W,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-amber-500 hover:text-amber-700",onClick:()=>z(t),children:e.jsx(ne,{className:"h-4 w-4"})})}),e.jsx(E,{children:e.jsx("p",{children:s("Edit")})})]})}),e.jsx(D,{children:e.jsxs(M,{children:[e.jsx(W,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-700",onClick:()=>G(t),children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsx(E,{children:e.jsx("p",{children:s("Delete")})})]})})]})})]},t.id))})]}),e.jsx($,{open:U,onOpenChange:d,children:e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(Q,{children:s(c?"Edit Webhook":"Add New Webhook")})}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"module",children:s("Module")}),e.jsxs(L,{value:m.module,onValueChange:t=>h(a=>({...a,module:t})),children:[e.jsx(O,{children:e.jsx(A,{placeholder:s("Select module")})}),e.jsxs(P,{children:[e.jsx(p,{value:"New User",children:s("New User")}),e.jsx(p,{value:"New Appointment",children:s("New Appointment")})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"method",children:s("Method")}),e.jsxs(L,{value:m.method,onValueChange:t=>h(a=>({...a,method:t})),children:[e.jsx(O,{children:e.jsx(A,{placeholder:s("Select method")})}),e.jsxs(P,{children:[e.jsx(p,{value:"GET",children:"GET"}),e.jsx(p,{value:"POST",children:"POST"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"url",children:s("URL")}),e.jsx(Y,{id:"url",type:"url",placeholder:"https://example.com/webhook",value:m.url,onChange:t=>h(a=>({...a,url:t.target.value})),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(x,{type:"button",variant:"outline",onClick:()=>d(!1),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),s("Cancel")]}),e.jsxs(x,{type:"submit",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),s(c?"Update":"Create")]})]})]})]})}),e.jsx(re,{isOpen:I,onClose:V,onConfirm:H,itemName:(n==null?void 0:n.module)||"",entityName:s("Webhook")})]})})}export{ke as default};
