import{r as x,j as e}from"./ui-C9UzXxo-.js";import{P as ue}from"./page-template-B2HXPu-s.js";import{u as je,K as fe,v as g,F as Q,C as u,q as j,r as f,w as _e,i as _,p as y,B as X,S as d,t as n}from"./app-CePVSpCk.js";import{T as Y,a as Z,b,c as o,d as ee,e as c}from"./table-C8TGnN1g.js";import{C as se}from"./CrudFormModal-BxbeyOXE.js";import{C as ye}from"./CrudDeleteModal-CqSiuuPI.js";import{C as be}from"./checkbox-DdUGEdGf.js";import{A as ve}from"./arrow-left-CLCYWjlI.js";import{S as Ne}from"./square-pen-Df-vO64U.js";import{T as Ce}from"./trash-D_jTiZX2.js";import{f as C}from"./utils-2yqaTY3d.js";import"./vendor-CxtKjBZA.js";import"./textarea-CiZFgYfM.js";import"./select-79vLaRYu.js";import"./index-BK2YBUn9.js";import"./chevron-up-FpzKnv5W.js";import"./language-BWaL1pXC.js";import"./CookieConsentBanner-9JM6Tk5v.js";import"./globe-DIoyL4mD.js";import"./switch-BT9_4soN.js";import"./copy-BbEiGrsE.js";import"./credit-card-Cw26BS3B.js";import"./settings-CabqR4KC.js";import"./dollar-sign-BZxmLz_1.js";import"./users-B2V-gWAi.js";import"./clock-DvHC5ovF.js";import"./coins-Curs0q0e.js";import"./user-Cs-z8Fus.js";import"./use-favicon-BlwZF4jE.js";/* empty css            *//* empty css                  */import"./radio-group-DixjSev-.js";import"./circle-hahOXJb0.js";import"./scroll-area-B6c1Z5Wm.js";function is(){var M,k,D,A,P,O,$,E,L,F,q,B,H,I,U,R,V,z,W,K,G,J;const{t:s}=je(),{auth:m,trainingSession:a,attendanceData:te}=fe().props,h=(m==null?void 0:m.permissions)||[],[ae,S]=x.useState(!1),[ne,v]=x.useState(!1),[ie,N]=x.useState(!1),[l,T]=x.useState(te||[]),re=()=>{d.get(route("hr.training-sessions.index"))},le=()=>{v(!0)},de=()=>{S(!0)},w=()=>{N(!0)},oe=(t,r)=>{T(l.map(i=>i.employee_id===t?{...i,is_present:r}:i))},ce=(t,r)=>{T(l.map(i=>i.employee_id===t?{...i,notes:r}:i))},me=t=>{const r={...t,start_date:t.start_date&&t.start_time?`${t.start_date} ${t.start_time}`:t.start_date,end_date:t.end_date&&t.end_time?`${t.end_date} ${t.end_time}`:t.end_date};delete r.start_time,delete r.end_time,n.loading(s("Updating session...")),d.put(route("hr.training-sessions.update",a.id),r,{onSuccess:i=>{v(!1),n.dismiss(),i.props.flash.success?n.success(s(i.props.flash.success)):i.props.flash.error&&n.error(s(i.props.flash.error))},onError:i=>{n.dismiss(),typeof i=="string"?n.error(s(i)):n.error(s("Failed to update session: {{errors}}",{errors:Object.values(i).join(", ")}))}})},pe=()=>{n.loading(s("Updating attendance...")),d.post(route("hr.training-sessions.update-attendance",a.id),{attendance:l},{onSuccess:t=>{N(!1),n.dismiss(),t.props.flash.success?n.success(s(t.props.flash.success)):t.props.flash.error&&n.error(s(t.props.flash.error))},onError:t=>{n.dismiss(),typeof t=="string"?n.error(s(t)):n.error(s("Failed to update attendance: {{errors}}",{errors:Object.values(t).join(", ")}))}})},he=()=>{n.loading(s("Deleting session...")),d.delete(route("hr.training-sessions.destroy",a.id),{onSuccess:t=>{n.dismiss(),t.props.flash.success?n.success(s(t.props.flash.success)):t.props.flash.error&&n.error(s(t.props.flash.error)),d.get(route("hr.training-sessions.index"))},onError:t=>{n.dismiss(),typeof t=="string"?n.error(s(t)):n.error(s("Failed to delete session: {{errors}}",{errors:Object.values(t).join(", ")}))}})},p=[];p.push({label:s("Back to List"),icon:e.jsx(ve,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:re}),g(h,"edit-training-sessions")&&p.push({label:s("Edit"),icon:e.jsx(Ne,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:le}),g(h,"delete-training-sessions")&&p.push({label:s("Delete"),icon:e.jsx(Ce,{className:"h-4 w-4 mr-2"}),variant:"destructive",onClick:de}),g(h,"manage-attendance")&&p.push({label:s("Manage Attendance"),icon:e.jsx(Q,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:w});const xe=[{title:s("Dashboard"),href:route("dashboard")},{title:s("HR Management"),href:route("hr.training-sessions.index")},{title:s("Training Management"),href:route("hr.training-sessions.index")},{title:s("Training Sessions"),href:route("hr.training-sessions.index")},{title:a.name||((M=a.training_program)==null?void 0:M.name)||""}],ge={scheduled:"bg-blue-50 text-blue-700 ring-blue-600/20",in_progress:"bg-amber-50 text-amber-700 ring-amber-600/20",completed:"bg-green-50 text-green-700 ring-green-600/20",cancelled:"bg-red-50 text-red-700 ring-red-600/20"};return e.jsxs(ue,{title:a.name||((k=a.training_program)==null?void 0:k.name)||"",url:`/hr/training/sessions/${a.id}`,actions:p,breadcrumbs:xe,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs(u,{className:"mb-6",children:[e.jsx(j,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(f,{className:"text-2xl",children:a.name||((D=a.training_program)==null?void 0:D.name)||""}),e.jsx(_e,{className:"mt-2",children:((A=a.training_program)==null?void 0:A.name)||""})]}),e.jsx(_,{className:`${ge[a.status]||""}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1).replace("_"," ")})]})}),e.jsxs(y,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Date")}),e.jsx("p",{children:((P=window.appSettings)==null?void 0:P.formatDateTime(a.start_date,!1))||C(new Date(a.start_date),"MMMM dd, yyyy")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Time")}),e.jsxs("p",{children:[(($=(O=window.appSettings)==null?void 0:O.formatDateTime(a.start_date,!0))==null?void 0:$.split(" ").slice(-2).join(" "))||C(new Date(a.start_date),"h:mm a")," - ",((L=(E=window.appSettings)==null?void 0:E.formatDateTime(a.end_date,!0))==null?void 0:L.split(" ").slice(-2).join(" "))||C(new Date(a.end_date),"h:mm a")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Duration")}),e.jsx("p",{children:new Date(a.end_date).getTime()-new Date(a.start_date).getTime()>0?`${Math.round((new Date(a.end_date).getTime()-new Date(a.start_date).getTime())/(1e3*60*60))} ${s("hours")}`:"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Location Type")}),e.jsx("p",{children:e.jsx(_,{variant:"outline",className:a.location_type==="virtual"?"bg-blue-50 text-blue-700":"bg-green-50 text-green-700",children:a.location_type==="virtual"?s("Virtual"):s("Physical")})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:a.location_type==="virtual"?s("Meeting Link"):s("Location")}),e.jsx("p",{children:a.location_type==="virtual"?a.meeting_link?e.jsx("a",{href:a.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:a.meeting_link}):"-":a.location||"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Created")}),e.jsx("p",{children:((F=m.user)==null?void 0:F.name)||"-"})]})]}),a.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Notes")}),e.jsx("p",{className:"mt-1",children:a.notes})]})]})]}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(f,{children:s("Attendance")})}),e.jsxs(y,{children:[l&&l.length>0?e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsxs(b,{children:[e.jsx(o,{children:s("Employee")}),e.jsx(o,{children:s("Status")}),e.jsx(o,{children:s("Notes")})]})}),e.jsx(ee,{children:l.map(t=>e.jsxs(b,{children:[e.jsxs(c,{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.employee_id_display})]}),e.jsx(c,{children:t.is_present?e.jsx(_,{variant:"outline",className:"bg-green-50 text-green-700",children:s("Present")}):e.jsx(_,{variant:"outline",className:"bg-red-50 text-red-700",children:s("Absent")})}),e.jsx(c,{children:t.notes||"-"})]},t.employee_id))})]}):e.jsx("div",{className:"text-center py-4 text-gray-500",children:s("No attendance data available")}),g(h,"manage-attendance")&&e.jsx("div",{className:"mt-4",children:e.jsxs(X,{variant:"default",onClick:w,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),s("Manage Attendance")]})})]})]})]}),e.jsxs("div",{children:[e.jsxs(u,{className:"mb-6",children:[e.jsx(j,{children:e.jsx(f,{children:s("Program Details")})}),e.jsxs(y,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Program")}),e.jsx("p",{className:"font-medium",children:((q=a.training_program)==null?void 0:q.name)||"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Training Program")}),e.jsx("p",{children:((B=a.training_program)==null?void 0:B.name)||"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Duration")}),e.jsx("p",{children:(H=a.training_program)!=null&&H.duration?`${a.training_program.duration} ${s("hours")}`:"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Cost")}),e.jsx("p",{children:(I=a.training_program)!=null&&I.cost?(U=window.appSettings)==null?void 0:U.formatCurrency(parseFloat(a.training_program.cost)):"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s("Capacity")}),e.jsx("p",{children:((R=a.training_program)==null?void 0:R.capacity)||"-"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(X,{variant:"outline",onClick:()=>d.get(route("hr.training-programs.show",a.training_program_id)),className:"w-full",children:s("View Program Details")})})]})]}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(f,{children:s("Trainers")})}),e.jsx(y,{children:a.trainers&&a.trainers.length>0?e.jsx("div",{className:"space-y-4",children:a.trainers.map(t=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-600 font-medium",children:t.name?t.name.charAt(0).toUpperCase():"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.email})]})]},t.id))}):e.jsx("div",{className:"text-center py-4 text-gray-500",children:s("No trainers assigned")})})]})]})]}),e.jsx(se,{isOpen:ne,onClose:()=>v(!1),onSubmit:me,formConfig:{fields:[{name:"training_program_id",label:s("Training Program"),type:"select",required:!0,options:[{value:a.training_program_id.toString(),label:((V=a.training_program)==null?void 0:V.name)||""}],disabled:!0},{name:"name",label:s("Session Name"),type:"text",helpText:s("Leave blank to use program name")},{name:"start_date",label:s("Start Date & Time"),type:"datetime-local",required:!0},{name:"end_date",label:s("End Date & Time"),type:"datetime-local",required:!0},{name:"location_type",label:s("Location Type"),type:"select",required:!0,options:[{value:"physical",label:s("Physical")},{value:"virtual",label:s("Virtual")}]},{name:"location",label:s("Location"),type:"text",showWhen:t=>t.location_type==="physical"},{name:"meeting_link",label:s("Meeting Link"),type:"text",showWhen:t=>t.location_type==="virtual"},{name:"status",label:s("Status"),type:"select",required:!0,options:[{value:"scheduled",label:s("Scheduled")},{value:"in_progress",label:s("In Progress")},{value:"completed",label:s("Completed")},{value:"cancelled",label:s("Cancelled")}]},{name:"notes",label:s("Notes"),type:"textarea"},{name:"trainer_ids",label:s("Trainers"),type:"multiselect",options:((z=m.trainers)==null?void 0:z.map(t=>({value:t.id.toString(),label:t.name})))||[]}],modalSize:"lg"},initialData:{...a,start_date:a.start_date?a.start_date.split(" ")[0]:"",start_time:a.start_date?(W=a.start_date.split(" ")[1])==null?void 0:W.substring(0,5):"",end_date:a.end_date?a.end_date.split(" ")[0]:"",end_time:a.end_date?(K=a.end_date.split(" ")[1])==null?void 0:K.substring(0,5):"",trainer_ids:(G=a.trainers)==null?void 0:G.map(t=>t.id.toString())},title:s("Edit Training Session"),mode:"edit"}),e.jsx(se,{isOpen:ie,onClose:()=>N(!1),onSubmit:pe,formConfig:{fields:[],modalSize:"lg",customContent:e.jsx("div",{className:"space-y-4",children:e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsxs(b,{children:[e.jsx(o,{children:s("Employee")}),e.jsx(o,{children:s("Present")}),e.jsx(o,{children:s("Notes")})]})}),e.jsx(ee,{children:l.map(t=>e.jsxs(b,{children:[e.jsxs(c,{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.employee_id_display})]}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(be,{id:`present-${t.employee_id}`,checked:t.is_present,onCheckedChange:r=>oe(t.employee_id,!!r)}),e.jsx("label",{htmlFor:`present-${t.employee_id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s("Present")})]})}),e.jsx(c,{children:e.jsx("input",{type:"text",value:t.notes||"",onChange:r=>ce(t.employee_id,r.target.value),className:"w-full p-2 border rounded-md",placeholder:s("Add notes")})})]},t.employee_id))})]})})},initialData:{},title:s("Manage Attendance"),mode:"custom",submitLabel:s("Save Attendance")}),e.jsx(ye,{isOpen:ae,onClose:()=>S(!1),onConfirm:he,itemName:a.name||((J=a.training_program)==null?void 0:J.name)||"",entityName:"training session"})]})}export{is as default};
