import{r as d,j as e}from"./ui-C9UzXxo-.js";import{P as $}from"./page-template-B2HXPu-s.js";import{u as q,K as H,B as x,C as S,q as k,r as _,w as E,p as T,i as h,I as L,x as M,t as o,S as p}from"./app-CePVSpCk.js";import{T as B}from"./textarea-CiZFgYfM.js";import{A as z}from"./arrow-left-CLCYWjlI.js";import{S as K}from"./star-Cn_AU9AC.js";import"./vendor-CxtKjBZA.js";import"./select-79vLaRYu.js";import"./index-BK2YBUn9.js";import"./chevron-up-FpzKnv5W.js";import"./language-BWaL1pXC.js";import"./CookieConsentBanner-9JM6Tk5v.js";import"./globe-DIoyL4mD.js";import"./switch-BT9_4soN.js";import"./copy-BbEiGrsE.js";import"./credit-card-Cw26BS3B.js";import"./settings-CabqR4KC.js";import"./dollar-sign-BZxmLz_1.js";import"./users-B2V-gWAi.js";import"./clock-DvHC5ovF.js";import"./coins-Curs0q0e.js";import"./user-Cs-z8Fus.js";import"./use-favicon-BlwZF4jE.js";/* empty css            *//* empty css                  */import"./utils-2yqaTY3d.js";function ve(){var y,w,N;const{t:s}=q(),{review:n,indicators:u}=H().props,[l,f]=d.useState(u.map(r=>({indicator_id:r.id,rating:r.rating||3,comments:r.comments||""}))),[j,D]=d.useState(""),[U,v]=d.useState({}),P=(r,a)=>{f(t=>{const i=[...t];return i[r]={...i[r],rating:a},i})},A=(r,a)=>{f(t=>{const i=[...t];return i[r]={...i[r],comments:a},i})},F=r=>{r.preventDefault();const a={};if(l.forEach((t,i)=>{t.rating||(a[`ratings.${i}.rating`]=s("Rating is required"))}),Object.keys(a).length>0){v(a);return}o.loading(s("Submitting review...")),p.post(route("hr.performance.employee-reviews.submit-ratings",n.id),{ratings:l,overall_comments:j},{onSuccess:t=>{o.dismiss(),t.props.flash.success&&o.success(s(t.props.flash.success)),p.visit(route("hr.performance.employee-reviews.show",n.id))},onError:t=>{o.dismiss(),v(t),typeof t=="string"?o.error(s(t)):o.error(s("Failed to submit review"))}})},g=()=>{p.visit(route("hr.performance.employee-reviews.show",n.id))},I=[{title:s("Dashboard"),href:route("dashboard")},{title:s("HR Management"),href:route("hr.performance.indicator-categories.index")},{title:s("Performance"),href:route("hr.performance.indicator-categories.index")},{title:s("Employee Reviews"),href:route("hr.performance.employee-reviews.index")},{title:s("Conduct Review")}],O=u.reduce((r,a)=>{const t=a.category||"Uncategorized";return r[t]||(r[t]=[]),r[t].push(a),r},{});return e.jsx($,{title:s("Conduct Performance Review"),url:`/hr/performance/employee-reviews/${n.id}/conduct`,breadcrumbs:I,children:e.jsx("form",{onSubmit:F,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between",children:e.jsxs(x,{type:"button",variant:"outline",onClick:g,children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),s("Back to Review")]})}),e.jsxs(S,{children:[e.jsxs(k,{children:[e.jsx(_,{children:s("Review Information")}),e.jsx(E,{children:s("You are conducting a performance review for:")})]}),e.jsx(T,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("Employee")}),e.jsx("p",{className:"mt-1 text-base font-semibold",children:(y=n.employee)==null?void 0:y.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("Review Cycle")}),e.jsx("p",{className:"mt-1 text-base font-semibold",children:(w=n.review_cycle)==null?void 0:w.name})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("Review Date")}),e.jsx("p",{className:"mt-1 text-base font-semibold",children:n.review_date?((N=window.appSettings)==null?void 0:N.formatDateTime(n.review_date,!1))||new Date(n.review_date).toLocaleString():"-"})]})})]})})]}),e.jsxs(S,{children:[e.jsxs(k,{children:[e.jsx(_,{children:s("Performance Ratings")}),e.jsx(E,{children:s("Rate the employee on each performance indicator")})]}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-8",children:[Object.entries(O).map(([r,a])=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-lg",children:r}),e.jsx("div",{className:"space-y-6",children:a.map((t,i)=>{var b,C,R;const m=l.findIndex(c=>c.indicator_id===t.id);return e.jsx("div",{className:"border rounded-md p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:t.description||s("No description")}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[t.measurement_unit&&e.jsxs(h,{variant:"outline",children:[s("Measurement"),": ",t.measurement_unit]}),t.target_value&&e.jsxs(h,{variant:"outline",children:[s("Target"),": ",t.target_value]}),e.jsxs(h,{variant:"outline",children:[s("Weight"),": ",t.weight]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:s("Rating")}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-lg font-bold mr-1",children:(b=l[m])==null?void 0:b.rating}),e.jsx(K,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"})]})]}),e.jsx(L,{type:"range",min:1,max:5,step:.5,value:(C=l[m])==null?void 0:C.rating,onChange:c=>P(m,parseFloat(c.target.value)),className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:s("Poor")}),e.jsx("span",{children:s("Average")}),e.jsx("span",{children:s("Excellent")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:`comments-${t.id}`,className:"text-sm font-medium",children:s("Comments")}),e.jsx(B,{id:`comments-${t.id}`,value:(R=l[m])==null?void 0:R.comments,onChange:c=>A(m,c.target.value),placeholder:s("Add specific feedback for this indicator"),rows:2})]})]})},t.id)})})]},r)),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"overall-comments",className:"text-sm font-medium",children:s("Overall Comments")}),e.jsx(B,{id:"overall-comments",value:j,onChange:r=>D(r.target.value),placeholder:s("Add overall feedback and recommendations"),rows:4})]})})]})}),e.jsxs(M,{className:"flex justify-between",children:[e.jsx(x,{type:"button",variant:"outline",onClick:g,children:s("Cancel")}),e.jsx(x,{type:"submit",children:s("Submit Review")})]})]})]})})})}export{ve as default};
