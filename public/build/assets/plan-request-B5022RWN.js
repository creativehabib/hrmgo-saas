import{r as f,j as c}from"./ui-C9UzXxo-.js";import{P as O}from"./page-template-B2HXPu-s.js";import{C as T}from"./CrudTable-Dqp1N8Wk.js";import{c as D}from"./columnRenderers-Dn4sYUs0.js";import{t as i}from"./i18n-_BYBrwL-.js";import{u as $,K as M,S as n,t as a}from"./app-CePVSpCk.js";import{P as V}from"./pagination-ByvlncqM.js";import{S as B}from"./search-and-filter-bar-B2CgZCxN.js";import"./vendor-CxtKjBZA.js";import"./textarea-CiZFgYfM.js";import"./select-79vLaRYu.js";import"./index-BK2YBUn9.js";import"./chevron-up-FpzKnv5W.js";import"./language-BWaL1pXC.js";import"./CookieConsentBanner-9JM6Tk5v.js";import"./globe-DIoyL4mD.js";import"./switch-BT9_4soN.js";import"./copy-BbEiGrsE.js";import"./credit-card-Cw26BS3B.js";import"./settings-CabqR4KC.js";import"./dollar-sign-BZxmLz_1.js";import"./users-B2V-gWAi.js";import"./clock-DvHC5ovF.js";import"./coins-Curs0q0e.js";import"./user-Cs-z8Fus.js";import"./use-favicon-BlwZF4jE.js";import"./table-C8TGnN1g.js";import"./ticket-DmZKwvAa.js";import"./unlink-BcdgK3yb.js";import"./wrench-CGU7Ft1Y.js";import"./arrow-left-CLCYWjlI.js";import"./arrow-right-C7JdH4Ti.js";import"./circle-help-C0S-oTMA.js";import"./lock-open-DSiBsvyN.js";import"./award-T4ZI43xQ.js";import"./wallet-DeVx02LK.js";import"./bell-CaHg65eG.js";import"./cookie-DINhGU1S.js";import"./building-2-Bxzvq01n.js";import"./building-CTTlMSBK.js";import"./trending-down-BBDyDMXb.js";import"./camera-B6YrOv6y.js";import"./chart-column-BuvtPv5K.js";import"./chart-no-axes-column-increasing-DpU2YTLr.js";import"./wifi-BWLuvSZA.js";import"./circle-alert-CPcUaQHG.js";import"./circle-check-big-QRVzFaq_.js";import"./circle-check-Bsqe1Oy2.js";import"./circle-hahOXJb0.js";import"./clipboard-list-CYu519l_.js";import"./code-DLKgizn0.js";import"./tag-DLA_9-Gh.js";import"./download-Dy8kf_tz.js";import"./ellipsis-B7Dcpmjs.js";import"./eye-off-D_POAzrb.js";import"./eye-Ds3O8uul.js";import"./instagram-DJ274emi.js";import"./filter-CJHBgxPm.js";import"./grip-vertical-GkNxvp67.js";import"./hard-drive-CvIusyLX.js";import"./heart-BxdfWe5j.js";import"./info-Cfzy708t.js";import"./layers-i14JjJ6T.js";import"./target-ChKhh3Jh.js";import"./link-2-Dyh9Asfo.js";import"./twitter-DvSPin83.js";import"./list-gVaFRlBo.js";import"./lock-BmEkJcEt.js";import"./mail-wmSCdBQm.js";import"./map-pin-CqHzBf39.js";import"./menu-C113HrJq.js";import"./monitor-CP12Y-ih.js";import"./phone-DUkL7MZF.js";import"./play-GEQInAgQ.js";import"./printer-CupyjDD-.js";import"./qr-code-C0PGAHLZ.js";import"./quote-DD8yfV5f.js";import"./refresh-cw-Dvtr6Xsn.js";import"./send-BHiBrVVZ.js";import"./server-B0O429oP.js";import"./shield-CGsXD3Oj.js";import"./square-pen-Df-vO64U.js";import"./star-Cn_AU9AC.js";import"./trash-2-3E96f3UA.js";import"./trash-D_jTiZX2.js";import"./trending-up-Ne7cjba9.js";import"./triangle-alert-CTrT4JQG.js";import"./type-uKUPsFU3.js";import"./user-plus-D-lxH5Xo.js";import"./zap-DH-5T0aI.js";/* empty css            *//* empty css                  */import"./utils-2yqaTY3d.js";const d={entity:{endpoint:route("plan-requests.index"),permissions:{view:"view-plan-requests",create:"create-plan-requests",edit:"edit-plan-requests",delete:"delete-plan-requests"}},description:i("Manage plan upgrade requests from users"),table:{columns:[{key:"user.name",label:i("Name"),sortable:!0},{key:"user.email",label:i("Email"),sortable:!0},{key:"plan.name",label:i("Plan Name"),sortable:!0},{key:"plan.duration",label:i("Plan Duration"),render:t=>t==="monthly"?i("Monthly"):i("Yearly")},{key:"status",label:i("Status"),render:D.status()},{key:"created_at",label:i("Requested At"),sortable:!0,render:t=>`${window.appSettings.formatDateTime(t,!1)}`}],actions:[{label:i("Approve"),icon:"Check",action:"approve",className:"text-green-600",condition:t=>t.status==="pending",requiredPermission:"approve-plan-requests"},{label:i("Reject"),icon:"X",action:"reject",className:"text-red-600",condition:t=>t.status==="pending",requiredPermission:"reject-plan-requests"}]},search:{placeholder:i("Search plan requests...")},filters:[{key:"status",label:i("Status"),type:"select",options:[{value:"all",label:i("All Status")},{value:"pending",label:i("Pending")},{value:"approved",label:i("Approved")},{value:"rejected",label:i("Rejected")}]}]};function Fr(){var v,P,x;const{t}=$(),{flash:I,planRequests:s,filters:l={},auth:h}=M().props,k=(h==null?void 0:h.permissions)||[],[p,y]=f.useState(l.search||""),[m,g]=f.useState({}),[q,F]=f.useState(!1);f.useEffect(()=>{var o;const r={};(o=d.filters)==null||o.forEach(e=>{r[e.key]=l[e.key]||"all"}),g(r)},[]);const w=(r,o)=>{r==="approve"?(a.loading(t("Approving plan request...")),n.post(route("plan-requests.approve",o.id),{},{onSuccess:e=>{a.dismiss(),e.props.flash.success?a.success(t(e.props.flash.success)):e.props.flash.error&&a.error(t(e.props.flash.error))},onError:e=>{a.dismiss(),typeof e=="string"?a.error(e):a.error(`Failed to approve plan request: ${Object.values(e).join(", ")}`)}})):r==="reject"&&(a.loading(t("Rejecting plan request...")),n.post(route("plan-requests.reject",o.id),{},{onSuccess:e=>{a.dismiss(),e.props.flash.success?a.success(t(e.props.flash.success)):e.props.flash.error&&a.error(t(e.props.flash.error))},onError:e=>{a.dismiss(),typeof e=="string"?a.error(e):a.error(`Failed to reject plan request: ${Object.values(e).join(", ")}`)}}))},A=r=>{r.preventDefault(),j()},j=()=>{const r={page:1};p&&(r.search=p),Object.entries(m).forEach(([o,e])=>{e&&e!=="all"&&(r[o]=e)}),l.per_page&&(r.per_page=l.per_page),n.get(route("plan-requests.index"),r,{preserveState:!0,preserveScroll:!0})},C=(r,o)=>{g(b=>({...b,[r]:o}));const e={page:1};p&&(e.search=p);const u={...m,[r]:o};Object.entries(u).forEach(([b,S])=>{S&&S!=="all"&&(e[b]=S)}),l.per_page&&(e.per_page=l.per_page),n.get(route("plan-requests.index"),e,{preserveState:!0,preserveScroll:!0})},E=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Plans"),href:route("plans.index")},{title:t("Plan Requests")}],_=()=>Object.entries(m).some(([r,o])=>o&&o!=="")||p!=="",N=(v=d.table.actions)==null?void 0:v.map(r=>({...r,label:t(r.label)}));return c.jsxs(O,{title:t("Plan Requests"),url:"/plan-requests",breadcrumbs:E,noPadding:!0,children:[c.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:c.jsx(B,{searchTerm:p,onSearchChange:y,onSearch:A,filters:((P=d.filters)==null?void 0:P.map(r=>{var o;return{name:r.key,label:t(r.label),type:"select",value:m[r.key]||"",onChange:e=>C(r.key,e),options:((o=r.options)==null?void 0:o.map(e=>({value:e.value,label:t(e.label)})))||[]}}))||[],showFilters:q,setShowFilters:F,hasActiveFilters:_,activeFilterCount:()=>Object.values(m).filter(r=>r&&r!=="").length+(p?1:0),onResetFilters:()=>{y(""),g({}),n.get(route("plan-requests.index"),{page:1},{preserveState:!0,preserveScroll:!0})},onApplyFilters:j,currentPerPage:((x=l.per_page)==null?void 0:x.toString())||"10",onPerPageChange:r=>{const o={page:1,per_page:parseInt(r)};p&&(o.search=p),Object.entries(m).forEach(([e,u])=>{u&&u!==""&&(o[e]=u)}),n.get(route("plan-requests.index"),o,{preserveState:!0,preserveScroll:!0})}})}),c.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[c.jsx(T,{columns:d.table.columns.map(r=>({...r,label:t(r.label)})),actions:N,data:(s==null?void 0:s.data)||[],from:(s==null?void 0:s.from)||1,onAction:w,permissions:k,entityPermissions:d.entity.permissions}),c.jsx(V,{from:(s==null?void 0:s.from)||0,to:(s==null?void 0:s.to)||0,total:(s==null?void 0:s.total)||0,links:s==null?void 0:s.links,entityName:t("plan requests"),onPageChange:r=>n.get(r)})]})]})}export{Fr as default};
